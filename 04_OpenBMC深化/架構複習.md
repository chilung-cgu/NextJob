# ğŸ–¥ï¸ OpenBMC æ¶æ§‹è¤‡ç¿’

> é€™æ˜¯ä½ çš„å„ªå‹¢ï¼é¢è©¦æ™‚å¯ä»¥æ·±å…¥å±•ç¤ºä½ çš„å°ˆæ¥­  
> æœ¬æ–‡ä»¶é‡å° **Meta Yosemite 4 å¹³å°**ï¼ˆä½¿ç”¨ entity-managerï¼‰

---

## ğŸ“Œ å¾é›¶é–‹å§‹ï¼šä»€éº¼æ˜¯ BMCï¼Ÿ

### ğŸ’¡ ç”Ÿæ´»åŒ–æ¯”å–»

```
æƒ³åƒä¸€å°ä¼ºæœå™¨æ˜¯ä¸€æ£Ÿå¤§æ¨“ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¼ºæœå™¨ = å¤§æ¨“                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   CPU = è¾¦å…¬å®¤çš„å“¡å·¥    RAM = è¾¦å…¬æ¡Œç©ºé–“   ç¡¬ç¢Ÿ = æª”æ¡ˆæ«ƒ      â”‚
â”‚   GPU = å°ˆæ¥­è¨­å‚™        ç¶²è·¯ = é›»æ¢¯/èµ°é“                      â”‚
â”‚                                                             â”‚
â”‚   é‚£èª°æ˜¯ã€Œå¤§æ¨“ç®¡ç†å“¡ã€å‘¢ï¼Ÿ                                    â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  BMC = å¤§æ¨“ç®¡ç†å“¡ï¼ˆBaseboard Management Controllerï¼‰  â”‚   â”‚
â”‚   â”‚                                                       â”‚   â”‚
â”‚   â”‚  è² è²¬ï¼š                                               â”‚   â”‚
â”‚   â”‚  âœ… é–‹é—œé›»æºï¼ˆé–‹/é—œæ•´æ£Ÿå¤§æ¨“çš„é›»ï¼‰                       â”‚   â”‚
â”‚   â”‚  âœ… ç›£æ§æº«åº¦ï¼ˆç¢ºä¿å†·æ°£æ­£å¸¸ã€ä¸æœƒéç†±ï¼‰                  â”‚   â”‚
â”‚   â”‚  âœ… çœ‹èª°é€²å‡ºï¼ˆé ç«¯é€£ç·šç®¡ç†ï¼‰                           â”‚   â”‚
â”‚   â”‚  âœ… è™•ç†ç·Šæ€¥ç‹€æ³ï¼ˆç•¶æ©Ÿæ™‚é ç«¯å¾©åŸï¼‰                      â”‚   â”‚
â”‚   â”‚  âœ… è¨˜éŒ„äº‹ä»¶ï¼ˆèª°ä½•æ™‚åšäº†ä»€éº¼ï¼‰                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   é‡é»ï¼šå³ä½¿å¤§æ¨“ï¼ˆä¼ºæœå™¨ï¼‰åœé›»/ç•¶æ©Ÿï¼Œ                         â”‚
â”‚         ç®¡ç†å“¡ï¼ˆBMCï¼‰é‚„æ˜¯å¯ä»¥ç¨ç«‹é‹ä½œï¼                       â”‚
â”‚         å› ç‚º BMC æœ‰è‡ªå·±çš„é›»æºã€CPUã€è¨˜æ†¶é«”ã€ç¶²è·¯              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”§ BMC çš„å¯¦éš›ç¡¬é«”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       BMC ç¡¬é«”çµ„æˆ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   BMC å…¶å¯¦æ˜¯ä¸€å¡Šç¨ç«‹çš„å°é›»è…¦ï¼Œç„Šåœ¨ä¸»æ©Ÿæ¿ä¸Šï¼š                   â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  BMC SoCï¼ˆå¸¸è¦‹å» ç‰Œï¼‰ï¼š                                â”‚   â”‚
â”‚   â”‚  - ASPEEDï¼šAST2500ã€AST2600ï¼ˆæœ€å¸¸è¦‹ï¼ï¼‰               â”‚   â”‚
â”‚   â”‚  - Nuvotonï¼šNPCM7xx ç³»åˆ—                             â”‚   â”‚
â”‚   â”‚                                                       â”‚   â”‚
â”‚   â”‚  ç¡¬é«”è¦æ ¼ï¼ˆä»¥ AST2600 ç‚ºä¾‹ï¼‰ï¼š                         â”‚   â”‚
â”‚   â”‚  - CPUï¼šARM Cortex-A7 é›™æ ¸å¿ƒ                         â”‚   â”‚
â”‚   â”‚  - RAMï¼šæœ€å¤š 1GB DDR4                                â”‚   â”‚
â”‚   â”‚  - Flashï¼šæ”¾ BMC éŸŒé«”ï¼ˆé€šå¸¸ 32-64MB SPI Flashï¼‰       â”‚   â”‚
â”‚   â”‚  - ä»‹é¢ï¼šI2Cã€SPIã€GPIOã€UARTã€ç¶²è·¯                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   ğŸ’¡ ä½ çš„ I2C/SPI/UART çŸ¥è­˜å°±æ˜¯ç”¨åœ¨é€™è£¡ï¼                    â”‚
â”‚      BMC é€éé€™äº›ä»‹é¢å’Œä¸»æ©Ÿæ¿ä¸Šçš„ Sensor/Fan/PSU æºé€š        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Œ OpenBMC æ˜¯ä»€éº¼ï¼Ÿ

```
OpenBMC æ˜¯ä¸€å€‹ Linux åŸºé‡‘æœƒçš„é–‹æºå°ˆæ¡ˆï¼Œç”¨æ–¼ï¼š
- ä¼ºæœå™¨çš„ Baseboard Management Controller (BMC)
- æä¾›é ç«¯ç®¡ç†å’Œç›£æ§åŠŸèƒ½
- æ›¿ä»£å°ˆæœ‰çš„ BMC éŸŒé«”ï¼ˆå¦‚ AMI MegaRACã€Insyde H2Oï¼‰

ä¸»è¦è²¢ç»è€…ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å…¬å¸       â”‚                   è²¢ç»é‡é»                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IBM            â”‚ OpenBMC å‰µå§‹è€…ï¼ŒPower ç³»çµ±                 â”‚
â”‚ Meta/Facebook  â”‚ Yosemite ç³»åˆ—å¹³å°ï¼ˆä½ ç”¨çš„ï¼ï¼‰              â”‚
â”‚ Google         â”‚ é›²ç«¯ä¼ºæœå™¨                                  â”‚
â”‚ Microsoft      â”‚ Azure ä¼ºæœå™¨                               â”‚
â”‚ Intel          â”‚ x86 å¹³å°æ”¯æ´                               â”‚
â”‚ AMD            â”‚ EPYC å¹³å°æ”¯æ´                              â”‚
â”‚ NVIDIA         â”‚ GPU ç®¡ç†ã€DGX ç³»çµ±                         â”‚
â”‚ Ampere         â”‚ ARM ä¼ºæœå™¨                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ ä½ çš„ OpenBMC ç¶“é©—å° NVIDIA/AMD éå¸¸æœ‰åƒ¹å€¼ï¼
   ä»–å€‘æ­£åœ¨ç©æ¥µæ‹›å‹Ÿæœ‰ OpenBMC ç¶“é©—çš„äººæ‰ï¼
```

### OpenBMC vs å‚³çµ± BMC éŸŒé«”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                â”‚    å‚³çµ± BMC éŸŒé«”    â”‚      OpenBMC       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸå§‹ç¢¼         â”‚ å°é–‰ã€å°ˆæœ‰          â”‚ å®Œå…¨é–‹æº           â”‚
â”‚ ä½œæ¥­ç³»çµ±       â”‚ å°ˆæœ‰ RTOS          â”‚ Linux              â”‚
â”‚ å®¢è£½åŒ–å½ˆæ€§     â”‚ ä½ï¼ˆè¦æ‰¾å» å•†æ”¹ï¼‰    â”‚ é«˜ï¼ˆè‡ªå·±æ”¹ï¼‰        â”‚
â”‚ ç¤¾ç¾¤æ”¯æ´       â”‚ ç„¡                  â”‚ æ´»èºçš„é–‹æºç¤¾ç¾¤      â”‚
â”‚ å®‰å…¨æ›´æ–°       â”‚ ä¾è³´å» å•†            â”‚ å¿«é€Ÿã€é€æ˜          â”‚
â”‚ é–‹ç™¼å·¥å…·       â”‚ å°ˆæœ‰å·¥å…·éˆ          â”‚ æ¨™æº– Linux å·¥å…·     â”‚
â”‚ å­¸ç¿’æ›²ç·š       â”‚ ä¾å» å•†æ–‡ä»¶          â”‚ æœ‰å…¬é–‹æ–‡ä»¶å’Œç¯„ä¾‹    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”· OpenBMC æ•´é«”æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OpenBMC æ¶æ§‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Management Interfaces               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Redfish â”‚  â”‚  IPMI   â”‚  â”‚   SSH   â”‚  â”‚  WebUI â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚            â”‚            â”‚            â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     D-Bus                            â”‚   â”‚
â”‚  â”‚     (phosphor-dbus-interfaces - å…±äº« API å®šç¾©)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚            â”‚            â”‚            â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Phosphor   â”‚ â”‚ Phosphor   â”‚ â”‚Phosphor â”‚ â”‚Phosphor â”‚     â”‚
â”‚  â”‚ Inventory  â”‚ â”‚   LED     â”‚ â”‚  Hwmon  â”‚ â”‚ Logging â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 Linux Kernel                         â”‚   â”‚
â”‚  â”‚  (Device Drivers, I2C, SPI, GPIO, hwmon, etc.)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Hardware                            â”‚   â”‚
â”‚  â”‚  (CPU, GPU, DIMM, PSU, Fan, Sensors, etc.)          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”· æ ¸å¿ƒå…ƒä»¶è©³è§£

### 1. D-Busï¼ˆæ ¸å¿ƒä¸­çš„æ ¸å¿ƒï¼ï¼‰

#### ğŸ’¡ D-Bus æ˜¯ä»€éº¼ï¼Ÿç”Ÿæ´»åŒ–æ¯”å–»

```
æƒ³åƒ OpenBMC æ˜¯ä¸€é–“å¤§å…¬å¸ï¼Œæ¯å€‹ã€Œæœå‹™ã€æ˜¯ä¸€å€‹ã€Œéƒ¨é–€ã€ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OpenBMC å…¬å¸                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ æ„Ÿæ¸¬å™¨  â”‚ â”‚  é›»æº   â”‚ â”‚  é¢¨æ‰‡   â”‚ â”‚  æ—¥èªŒ   â”‚           â”‚
â”‚  â”‚  éƒ¨é–€   â”‚ â”‚  éƒ¨é–€   â”‚ â”‚  éƒ¨é–€   â”‚ â”‚  éƒ¨é–€   â”‚           â”‚
â”‚  â”‚(Hwmon)  â”‚ â”‚ (PSU)   â”‚ â”‚ (Fan)   â”‚ â”‚(Logging)â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â”‚
â”‚       â”‚          â”‚          â”‚          â”‚                   â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                      â”‚                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚              â”‚    D-Bus      â”‚  â† å…¬å¸çš„ã€Œå…§éƒ¨é€šè¨Šç³»çµ±ã€     â”‚
â”‚              â”‚  (Message Bus)â”‚     åƒæ˜¯ Email + é›»è©±ç¸½æ©Ÿ     â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                             â”‚
â”‚  D-Bus çš„åŠŸèƒ½ï¼š                                              â”‚
â”‚  1. è®“éƒ¨é–€ä¹‹é–“å¯ä»¥äº’ç›¸æºé€šï¼ˆä¸ç”¨ç›´æ¥èªè­˜å°æ–¹ï¼‰                 â”‚
â”‚  2. å¯ä»¥ã€Œå»£æ’­ã€è¨Šæ¯çµ¦æ‰€æœ‰äººï¼ˆä¾‹å¦‚ï¼šæº«åº¦å¤ªé«˜è­¦å ±ï¼ï¼‰           â”‚
â”‚  3. å¯ä»¥æŸ¥è©¢å…¶ä»–éƒ¨é–€çš„ç‹€æ…‹ï¼ˆä¾‹å¦‚ï¼šé¢¨æ‰‡éƒ¨é–€ï¼Œä½ å€‘è½‰é€Ÿå¤šå°‘ï¼Ÿï¼‰    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ”‘ D-Bus å››å¤§æ ¸å¿ƒæ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Service Nameï¼ˆæœå‹™åç¨±ï¼‰= éƒ¨é–€åç¨±                       â”‚
â”‚     â””â”€â”€ ä¾‹ï¼šxyz.openbmc_project.Hwmon                       â”‚
â”‚         é¡ä¼¼å…¬å¸è£¡çš„ã€Œæ„Ÿæ¸¬å™¨éƒ¨é–€ã€                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Object Pathï¼ˆç‰©ä»¶è·¯å¾‘ï¼‰= è©²éƒ¨é–€ç®¡ç†çš„ã€Œå…·é«”ç‰©ä»¶ã€         â”‚
â”‚     â””â”€â”€ ä¾‹ï¼š/xyz/openbmc_project/sensors/temperature/cpu0   â”‚
â”‚         é¡ä¼¼ã€Œæ„Ÿæ¸¬å™¨éƒ¨é–€ç®¡ç†çš„ CPU0 æº«åº¦è¨ˆã€                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Interfaceï¼ˆä»‹é¢ï¼‰= é€™å€‹ç‰©ä»¶å¯ä»¥åšä»€éº¼                    â”‚
â”‚     â””â”€â”€ ä¾‹ï¼šxyz.openbmc_project.Sensor.Value                â”‚
â”‚         é¡ä¼¼ã€Œé€™å€‹æº«åº¦è¨ˆå¯ä»¥è®€å–æ•¸å€¼ã€                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. Propertyï¼ˆå±¬æ€§ï¼‰= å¯¦éš›çš„è³‡æ–™                            â”‚
â”‚     â””â”€â”€ ä¾‹ï¼šValue = 45.5ï¼ˆç›®å‰æº«åº¦ 45.5 åº¦ï¼‰                 â”‚
â”‚         é¡ä¼¼ã€Œæº«åº¦è¨ˆé¡¯ç¤ºçš„æ•¸å­—ã€                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®Œæ•´ä¾‹å­ï¼š
ã€Œè«‹å• xyz.openbmc_project.Hwmon æœå‹™ï¼ˆæ„Ÿæ¸¬å™¨éƒ¨é–€ï¼‰ï¼Œ
 /xyz/openbmc_project/sensors/temperature/cpu0ï¼ˆCPU0 æº«åº¦è¨ˆï¼‰
 çš„ xyz.openbmc_project.Sensor.Valueï¼ˆè®€æ•¸åŠŸèƒ½ï¼‰
 çš„ Value å±¬æ€§ï¼ˆå¯¦éš›æ•¸å€¼ï¼‰æ˜¯å¤šå°‘ï¼Ÿã€

ç­”ï¼š45.5
```

#### ğŸ› ï¸ å¸¸ç”¨ busctl å‘½ä»¤ï¼ˆå¯¦æˆ°å¿…å‚™ï¼ï¼‰

```bash
# 1. åˆ—å‡ºæ‰€æœ‰æœå‹™ï¼ˆçœ‹å…¬å¸æœ‰å“ªäº›éƒ¨é–€ï¼‰
busctl list

# 2. æŸ¥çœ‹æŸæœå‹™çš„ç‰©ä»¶æ¨¹ï¼ˆçœ‹é€™å€‹éƒ¨é–€ç®¡ç†å“ªäº›æ±è¥¿ï¼‰
busctl tree xyz.openbmc_project.Hwmon

# è¼¸å‡ºç¯„ä¾‹ï¼š
# â””â”€/xyz/openbmc_project/sensors
#   â”œâ”€/xyz/openbmc_project/sensors/temperature
#   â”‚ â”œâ”€/xyz/openbmc_project/sensors/temperature/cpu0
#   â”‚ â””â”€/xyz/openbmc_project/sensors/temperature/cpu1
#   â””â”€/xyz/openbmc_project/sensors/fan
#     â””â”€/xyz/openbmc_project/sensors/fan/fan0

# 3. æŸ¥çœ‹ç‰©ä»¶æœ‰å“ªäº›ä»‹é¢å’Œå±¬æ€§
busctl introspect xyz.openbmc_project.Hwmon \
    /xyz/openbmc_project/sensors/temperature/cpu0

# 4. è®€å–å–®ä¸€å±¬æ€§
busctl get-property xyz.openbmc_project.Hwmon \
    /xyz/openbmc_project/sensors/temperature/cpu0 \
    xyz.openbmc_project.Sensor.Value Value

# è¼¸å‡ºï¼šd 45.5  ï¼ˆd = double å‹æ…‹ï¼Œå€¼ = 45.5ï¼‰

# 5. å‘¼å«æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼šé–‹æ©Ÿï¼‰
busctl call xyz.openbmc_project.State.Host \
    /xyz/openbmc_project/state/host0 \
    xyz.openbmc_project.State.Host \
    RequestedHostTransition s \
    "xyz.openbmc_project.State.Host.Transition.On"

# 6. å³æ™‚ç›£æ§ D-Bus è¨Šæ¯ï¼ˆDebug è¶…å¥½ç”¨ï¼ï¼‰
busctl monitor
```

### 2. phosphor-dbus-interfaces

```
é€™å€‹ repository å®šç¾©äº† OpenBMC çš„ D-Bus APIã€‚

è·¯å¾‘çµæ§‹ï¼š
yaml/
â””â”€â”€ xyz/
    â””â”€â”€ openbmc_project/
        â”œâ”€â”€ Sensor/
        â”‚   â””â”€â”€ Value.interface.yaml
        â”œâ”€â”€ State/
        â”‚   â”œâ”€â”€ Host.interface.yaml
        â”‚   â””â”€â”€ Chassis.interface.yaml
        â””â”€â”€ Inventory/
            â””â”€â”€ Item.interface.yaml

Interface å®šç¾©ç¯„ä¾‹ï¼š
# xyz/openbmc_project/Sensor/Value.interface.yaml
description: A sensor value
properties:
  - name: Value
    type: double
    description: The sensor value
  - name: Unit
    type: string
    description: The unit of measurement
```

### 3. phosphor-hwmon

```
è² è²¬è®€å–ç¡¬é«”æ„Ÿæ¸¬å™¨æ•¸å€¼ã€‚

é‹ä½œæ–¹å¼ï¼š
1. è®€å– Linux hwmon sysfs (/sys/class/hwmon)
2. å°‡æ•¸å€¼é€é D-Bus ç™¼å¸ƒ
3. æä¾› Sensor.Value ä»‹é¢

è¨­å®šæª”ä½ç½®ï¼š
/etc/default/obmc/hwmon/

è¨­å®šæª”ç¯„ä¾‹ï¼š
# 48-0048.conf (I2C device at address 0x48)
LABEL_temp1=cpu0_temp
LABEL_temp2=cpu1_temp
```

### 4. Entity-Managerï¼ˆMeta Yosemite 4 ä½¿ç”¨é€™å€‹ï¼ï¼‰

> âš ï¸ æ³¨æ„ï¼šOpenBMC æœ‰å…©ç¨®ç¡¬é«”ç®¡ç†æ–¹å¼ï¼š
> - **phosphor-inventory-manager**ï¼šå‚³çµ±æ–¹å¼ï¼Œä½¿ç”¨éœæ…‹ YAML è¨­å®š
> - **entity-manager**ï¼šç¾ä»£æ–¹å¼ï¼Œä½¿ç”¨å‹•æ…‹ JSON è¨­å®šï¼ˆYosemite 4 ä½¿ç”¨é€™å€‹ï¼ï¼‰

#### ğŸ’¡ Entity-Manager vs Inventory-Manager æ¯”è¼ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â”‚ phosphor-inventory  â”‚   entity-manager    â”‚
â”‚                    â”‚     -manager        â”‚  ï¼ˆä½ ç”¨çš„ï¼ï¼‰        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¨­å®šæ ¼å¼           â”‚ YAML                â”‚ JSON                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¨­å®šæ–¹å¼           â”‚ éœæ…‹ç·¨è­¯            â”‚ å‹•æ…‹è¼‰å…¥            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¡¬é«”åµæ¸¬           â”‚ æ‰‹å‹•å®šç¾©            â”‚ è‡ªå‹•æ¢æ¸¬ï¼ˆProbeï¼‰   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å½ˆæ€§               â”‚ è¼ƒä½                â”‚ è¼ƒé«˜                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é©ç”¨å ´æ™¯           â”‚ å›ºå®šç¡¬é«”é…ç½®        â”‚ å¯è®Šç¡¬é«”é…ç½®        â”‚
â”‚                    â”‚                     â”‚ ï¼ˆå¦‚å¤š Slot ç³»çµ±ï¼‰  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½¿ç”¨å» å•†           â”‚ IBM                 â”‚ Metaã€Intelã€Google â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ”§ Entity-Manager é‹ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Entity-Manager æ¶æ§‹                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. JSON è¨­å®šæª”ï¼ˆå®šç¾©ç¡¬é«”é…ç½®ï¼‰                               â”‚
â”‚     â””â”€â”€ /usr/share/entity-manager/configurations/           â”‚
â”‚         â”œâ”€â”€ Yosemite4.json                                  â”‚
â”‚         â”œâ”€â”€ Yosemite4_Slot1.json                            â”‚
â”‚         â””â”€â”€ ...                                             â”‚
â”‚                                                             â”‚
â”‚  2. Probe æ©Ÿåˆ¶ï¼ˆè‡ªå‹•åµæ¸¬ç¡¬é«”ï¼‰                                â”‚
â”‚     â””â”€â”€ Entity-Manager æœƒå» I2C/GPIO æ¢æ¸¬                   â”‚
â”‚         å¦‚æœç™¼ç¾ç¬¦åˆæ¢ä»¶çš„ç¡¬é«”ï¼Œå°±è¼‰å…¥å°æ‡‰è¨­å®š                 â”‚
â”‚                                                             â”‚
â”‚  3. ç™¼å¸ƒåˆ° D-Bus                                             â”‚
â”‚     â””â”€â”€ åµæ¸¬åˆ°çš„ç¡¬é«”è³‡è¨Šæœƒç™¼å¸ƒåˆ° D-Bus                       â”‚
â”‚         å…¶ä»–æœå‹™ï¼ˆå¦‚ dbus-sensorsï¼‰æœƒè¨‚é–±é€™äº›è³‡è¨Š             â”‚
â”‚                                                             â”‚
â”‚  æµç¨‹åœ–ï¼š                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ JSON è¨­å®š  â”‚â”€â”€â”€â†’â”‚ Entity-Managerâ”‚â”€â”€â”€â†’â”‚   D-Bus     â”‚     â”‚
â”‚  â”‚  (éœæ…‹)    â”‚    â”‚  (Probe åµæ¸¬) â”‚    â”‚  (ç™¼å¸ƒ)     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                 â”‚            â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                                    â–¼                   â–¼     â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                              â”‚dbus-sensorsâ”‚     â”‚  Redfish  â”‚â”‚
â”‚                              â”‚ (è®€ Sensor)â”‚     â”‚  (API)    â”‚â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ“ Entity-Manager JSON è¨­å®šæª”ç¯„ä¾‹

```json
// /usr/share/entity-manager/configurations/Yosemite4_Example.json
{
    "Exposes": [
        {
            "Name": "CPU0 Temperature",
            "Type": "TMP75",           // ä½¿ç”¨ TMP75 æº«åº¦ Sensor
            "Bus": 2,                   // I2C Bus 2
            "Address": "0x48"           // I2C åœ°å€ 0x48
        },
        {
            "Name": "PSU0 Power",
            "Type": "ADM1278",          // ä½¿ç”¨ ADM1278 é›»æºç®¡ç† IC
            "Bus": 5,
            "Address": "0x10"
        }
    ],
    "Probe": "TRUE",                    // æ°¸é è¼‰å…¥ï¼ˆæˆ–å¯è¨­æ¢ä»¶ï¼‰
    "Name": "Yosemite4 Slot1",
    "Type": "Board"
}
```

#### ğŸ› ï¸ Entity-Manager Debug å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹ Entity-Manager åµæ¸¬åˆ°å“ªäº›ç¡¬é«”
busctl tree xyz.openbmc_project.EntityManager

# æŸ¥çœ‹æŸå€‹ç¡¬é«”çš„è©³ç´°è¨­å®š
busctl introspect xyz.openbmc_project.EntityManager \
    /xyz/openbmc_project/inventory/system/board/Yosemite4_Slot1

# æŸ¥çœ‹ Entity-Manager çš„ Log
journalctl -u xyz.openbmc_project.EntityManager

# å¼·åˆ¶é‡æ–°è¼‰å…¥è¨­å®šï¼ˆå¦‚æœæ”¹äº† JSONï¼‰
systemctl restart xyz.openbmc_project.EntityManager
```

#### Meta Yosemite 4 å¹³å°ç›¸é—œ

```
Yosemite 4 æ˜¯ Meta çš„é–‹æ”¾é‹ç®—å¹³å°ï¼ˆOCPï¼‰ï¼Œç‰¹é»ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Yosemite 4 æ¶æ§‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Management Module                   â”‚   â”‚
â”‚  â”‚  (BMC ä¸»æ§æ¿ï¼Œé‹è¡Œ OpenBMC)                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚          â”‚          â”‚          â”‚              â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚       â”‚ Slot 1  â”‚ â”‚ Slot 2  â”‚ â”‚ Slot 3  â”‚ â”‚ Slot 4  â”‚      â”‚
â”‚       â”‚(é‹ç®—å¡) â”‚ â”‚(é‹ç®—å¡) â”‚ â”‚(é‹ç®—å¡) â”‚ â”‚(é‹ç®—å¡) â”‚      â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                             â”‚
â”‚  æ¯å€‹ Slot å¯ä»¥æ”¾ä¸åŒé¡å‹çš„é‹ç®—å¡ï¼ˆCPUã€GPUã€åŠ é€Ÿå™¨ç­‰ï¼‰       â”‚
â”‚  é€™å°±æ˜¯ç‚ºä»€éº¼éœ€è¦ Entity-Managerï¼š                           â”‚
â”‚  â†’ å‹•æ…‹åµæ¸¬æ¯å€‹ Slot æ’äº†ä»€éº¼å¡                              â”‚
â”‚  â†’ æ ¹æ“šä¸åŒçš„å¡è¼‰å…¥ä¸åŒçš„ Sensor è¨­å®š                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. phosphor-logging

```
è™•ç†ç³»çµ±æ—¥èªŒå’ŒéŒ¯èª¤ã€‚

åŠŸèƒ½ï¼š
- è¨˜éŒ„ç³»çµ±äº‹ä»¶
- ç®¡ç† SEL (System Event Log)
- é€é Redfish å’Œ IPMI æä¾›æ—¥èªŒå­˜å–
```

---

## ğŸ”· ç®¡ç†ä»‹é¢

### IPMI

```
IPMI (Intelligent Platform Management Interface)

å¸¸è¦‹æ“ä½œï¼š
# é›»æºæ§åˆ¶
ipmitool -I lanplus -H <bmc-ip> -U admin -P password power on
ipmitool -I lanplus -H <bmc-ip> -U admin -P password power off
ipmitool -I lanplus -H <bmc-ip> -U admin -P password power cycle

# è®€å–æ„Ÿæ¸¬å™¨
ipmitool -I lanplus -H <bmc-ip> -U admin -P password sensor list

# æŸ¥çœ‹ SEL
ipmitool -I lanplus -H <bmc-ip> -U admin -P password sel list

# SOL (Serial over LAN)
ipmitool -I lanplus -H <bmc-ip> -U admin -P password sol activate
```

### Redfish

```
Redfish æ˜¯ç¾ä»£çš„ RESTful API æ¨™æº–ã€‚

å„ªé»ï¼ˆç›¸è¼ƒæ–¼ IPMIï¼‰ï¼š
- åŸºæ–¼ HTTPSï¼Œæ›´å®‰å…¨
- JSON æ ¼å¼ï¼Œæ˜“æ–¼ä½¿ç”¨
- æ›´è±å¯Œçš„åŠŸèƒ½å’Œæ“´å±•æ€§

ç¯„ä¾‹ APIï¼š
# å–å¾—ç³»çµ±è³‡è¨Š
GET /redfish/v1/Systems/system

# å–å¾— Chassis è³‡è¨Š
GET /redfish/v1/Chassis/chassis

# å–å¾—æ„Ÿæ¸¬å™¨
GET /redfish/v1/Chassis/chassis/Sensors

# é›»æºæ§åˆ¶
POST /redfish/v1/Systems/system/Actions/ComputerSystem.Reset
{
    "ResetType": "On"
}
```

---

## ğŸ”· Build System (Yocto)

```
OpenBMC ä½¿ç”¨ Yocto Project ä½œç‚º build systemã€‚

é‡è¦ç›®éŒ„ï¼š
poky/              # Yocto æ ¸å¿ƒ
meta-openembedded/ # ç¤¾ç¾¤ layers
meta-phosphor/     # OpenBMC æ ¸å¿ƒ recipes
meta-xxx/          # å» å•†ç‰¹å®šçš„ layer

å¸¸ç”¨å‘½ä»¤ï¼š
# åˆå§‹åŒ– build ç’°å¢ƒ
source setup <machine>

# é–‹å§‹ build
bitbake obmc-phosphor-image

# Build å–®ä¸€ package
bitbake phosphor-hwmon

# é–‹ç™¼æ¨¡å¼
devtool modify phosphor-hwmon
devtool build phosphor-hwmon
devtool reset phosphor-hwmon
```

---

## ğŸ“ é¢è©¦æœƒå•çš„ OpenBMC å•é¡Œ

### ğŸ¯ åŸºç¤é¡Œ

**Q1ï¼šOpenBMC çš„æ•´é«”æ¶æ§‹æ˜¯ä»€éº¼ï¼Ÿ**

```
ã€ŒOpenBMC æ˜¯ä¸€å€‹åŸºæ–¼ Linux çš„é–‹æº BMC éŸŒé«”å°ˆæ¡ˆï¼Œ
ç”± Linux åŸºé‡‘æœƒè¨—ç®¡ï¼Œä¸»è¦è²¢ç»è€…åŒ…æ‹¬ IBMã€Metaã€Googleã€Intel ç­‰ã€‚

æ•´é«”æ¶æ§‹å¾ä¸‹åˆ°ä¸Šåˆ†ç‚ºå››å±¤ï¼š

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 4. â”‚  Management Interfaces                          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ Redfish â”‚ â”‚  IPMI   â”‚ â”‚   SSH   â”‚ â”‚ WebUI â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
 3. â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â”‚              D-Bus (System Bus)                 â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚  â”‚  Hwmon   â”‚ â”‚ Logging  â”‚ â”‚  State   â”‚ ...   â”‚
    â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 2. â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â”‚              Linux Kernel                       â”‚
    â”‚  (I2C driver, SPI driver, GPIO, hwmon)         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 1. â”‚              Hardware                           â”‚
    â”‚  (BMC SoC, Sensors, PSU, Fan, Host CPU)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ¸å¿ƒç‰¹é»ï¼š
1. ä½¿ç”¨ D-Bus ä½œç‚º IPC æ©Ÿåˆ¶ï¼Œæ‰€æœ‰æœå‹™é€é D-Bus æºé€š
2. ä½¿ç”¨ systemd ç®¡ç†æœå‹™ç”Ÿå‘½é€±æœŸ
3. ä½¿ç”¨ Yocto ä½œç‚º build system
4. å„å…ƒä»¶é«˜åº¦æ¨¡çµ„åŒ–ï¼Œå¯ç¨ç«‹é–‹ç™¼å’Œæ›´æ–°

èˆ‡å‚³çµ± BMC éŸŒé«”çš„å·®ç•°ï¼š
- é–‹æº vs å°é–‰
- Linux vs å°ˆæœ‰ RTOS
- ç¤¾ç¾¤é©…å‹• vs å» å•†é–å®šã€
```

---

**Q2ï¼šD-Bus åœ¨ OpenBMC ä¸­æ‰®æ¼”ä»€éº¼è§’è‰²ï¼Ÿ**

```
ã€ŒD-Bus æ˜¯ OpenBMC çš„æ ¸å¿ƒé€šè¨Šæ©Ÿåˆ¶ï¼Œå¯ä»¥æƒ³åƒæˆç³»çµ±çš„ã€ç¥ç¶“ç¶²è·¯ã€ã€‚

D-Bus çš„å››å¤§åŠŸèƒ½ï¼š

1. æœå‹™ç™¼ç¾ (Service Discovery)
   - æœå‹™å•Ÿå‹•æ™‚å‘ D-Bus è¨»å†Š
   - å…¶ä»–æœå‹™å¯ä»¥å‹•æ…‹ç™¼ç¾æ–°æœå‹™
   - ä¾‹å¦‚ï¼šEntity-Manager åµæ¸¬åˆ°æ–°ç¡¬é«”å¾Œï¼Œ
     dbus-sensors å¯ä»¥ç«‹å³ç™¼ç¾ä¸¦é–‹å§‹è®€å–

2. æ–¹æ³•å‘¼å« (Method Call)
   - é¡ä¼¼ RPC (Remote Procedure Call)
   - ä¾‹å¦‚ï¼šRedfish å‘¼å« State.Host.RequestedHostTransition ä¾†é–‹æ©Ÿ

3. å±¬æ€§å­˜å– (Property Access)
   - é€é Get/Set è®€å–å’Œè¨­å®šç‹€æ…‹
   - ä¾‹å¦‚ï¼šRedfish è®€å– Sensor.Value å–å¾—æº«åº¦

4. ä¿¡è™Ÿå»£æ’­ (Signal)
   - äº‹ä»¶é€šçŸ¥æ©Ÿåˆ¶ï¼Œä¸€å°å¤š
   - ä¾‹å¦‚ï¼šæº«åº¦è¶…éé–¥å€¼æ™‚å»£æ’­ ThresholdCritical ä¿¡è™Ÿ

ç‚ºä»€éº¼é¸æ“‡ D-Busï¼Ÿ
- é¬†è€¦åˆï¼šæœå‹™é–“ä¸éœ€è¦ç›´æ¥ç›¸ä¾
- æ¨™æº–åŒ–ï¼šphosphor-dbus-interfaces å®šç¾©çµ±ä¸€ API
- å¯è§€å¯Ÿï¼šç”¨ busctl å¯ä»¥ç›£æ§æ‰€æœ‰é€šè¨Šï¼Œæ–¹ä¾¿ debug
- èªè¨€ç„¡é—œï¼šC++ã€Pythonã€Go éƒ½å¯ä»¥ä½¿ç”¨

å¯¦éš›æ¡ˆä¾‹ï¼š
ç•¶ä½¿ç”¨è€…é€é Redfish è®€å–æº«åº¦æ™‚ï¼š
Redfish â†’ D-Bus get-property â†’ phosphor-hwmon â†’ å›å‚³æ•¸å€¼
```

---

**Q3ï¼šè«‹èªªæ˜ Sensor è³‡æ–™å¾ç¡¬é«”åˆ° Redfish API çš„å®Œæ•´æµç¨‹**

```
ã€Œé€™å€‹å•é¡Œå±•ç¤ºä½ å°æ•´é«”æ¶æ§‹çš„ç†è§£ã€‚å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š

1. ç¡¬é«”å±¤
   â”œâ”€ I2C Sensorï¼ˆå¦‚ TMP75ï¼‰é€£æ¥åœ¨ I2C Bus ä¸Š
   â””â”€ Linux hwmon driver è¼‰å…¥ï¼Œå»ºç«‹ sysfs ç¯€é»
      /sys/class/hwmon/hwmon0/temp1_input

2. Kernel å±¤
   â””â”€ hwmon driver é€±æœŸæ€§è®€å– I2C æš«å­˜å™¨
      ä¸¦æ›´æ–° sysfs æª”æ¡ˆå…§å®¹ï¼ˆå–®ä½é€šå¸¸æ˜¯ milli-degreeï¼‰

3. Phosphor å±¤ï¼ˆå…©ç¨®æ–¹å¼ï¼Œè¦–å¹³å°è€Œå®šï¼‰

   æ–¹å¼ Aï¼šphosphor-hwmonï¼ˆå‚³çµ±ï¼‰
   â””â”€ è®€å– /sys/class/hwmon/*/temp*_input
      é€éè¨­å®šæª”å®šç¾© Sensor åç¨±å°æ‡‰

   æ–¹å¼ Bï¼šdbus-sensors + entity-managerï¼ˆç¾ä»£ï¼ŒYosemite 4 ä½¿ç”¨ï¼‰
   â””â”€ entity-manager è®€å– JSON è¨­å®šï¼Œåµæ¸¬ I2C è£ç½®
   â””â”€ dbus-sensors æ ¹æ“šè¨­å®šå»ºç«‹ Sensor ç‰©ä»¶

4. D-Bus å±¤
   â””â”€ Sensor ä»¥ D-Bus ç‰©ä»¶ç™¼å¸ƒ
      Service: xyz.openbmc_project.HwmonTempSensor
      Object:  /xyz/openbmc_project/sensors/temperature/CPU0_Temp
      Interface: xyz.openbmc_project.Sensor.Value
      Property: Value = 45.5

5. Management å±¤
   â””â”€ bmcweb (Redfish service) è¨‚é–± D-Bus
      æ”¶åˆ° GET /redfish/v1/Chassis/chassis/Sensors/CPU0_Temp
      â†’ æŸ¥è©¢ D-Bus å–å¾—æ•¸å€¼
      â†’ å›å‚³ JSONï¼š{ "Reading": 45.5, "ReadingUnits": "Cel" }

å¯¦éš› Debug æ–¹å¼ï¼š
1. cat /sys/class/hwmon/hwmon0/temp1_input  # ç¢ºèª kernel å±¤
2. busctl get-property ... Sensor.Value Value  # ç¢ºèª D-Bus å±¤
3. curl -k https://bmc/redfish/v1/.../Sensors/CPU0_Temp  # ç¢ºèª API å±¤
```

---

### ğŸ¯ é€²éšé¡Œï¼ˆå±•ç¤ºæ·±åº¦ï¼ï¼‰

**Q4ï¼šEntity-Manager å’Œ phosphor-inventory-manager æœ‰ä»€éº¼å·®ç•°ï¼Ÿä½ å€‘å¹³å°ç”¨å“ªå€‹ï¼Ÿ**

```
ã€Œæˆ‘å€‘ä½¿ç”¨çš„ Meta Yosemite 4 å¹³å°æ˜¯ç”¨ entity-managerã€‚
é€™å…©è€…æ˜¯ OpenBMC å…©ç¨®ä¸åŒçš„ç¡¬é«”ç®¡ç†æ©Ÿåˆ¶ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ phosphor-inventory   â”‚   entity-manager     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¨­å®šæ ¼å¼        â”‚ YAML                 â”‚ JSON                 â”‚
â”‚ è¼‰å…¥æ™‚æ©Ÿ        â”‚ ç·¨è­¯æ™‚               â”‚ åŸ·è¡Œæ™‚               â”‚
â”‚ ç¡¬é«”åµæ¸¬        â”‚ éœæ…‹å®šç¾©             â”‚ å‹•æ…‹ Probe           â”‚
â”‚ é©ç”¨å ´æ™¯        â”‚ å›ºå®šç¡¬é«”é…ç½®         â”‚ å¯è®Šç¡¬é«”é…ç½®         â”‚
â”‚ ä»£è¡¨å» å•†        â”‚ IBM (Power)          â”‚ Meta, Intel, Google  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚ºä»€éº¼ Yosemite 4 é¸æ“‡ entity-managerï¼Ÿ

Yosemite 4 æ˜¯å¤š Slot è¨­è¨ˆï¼Œæ¯å€‹ Slot å¯ä»¥æ’ä¸åŒçš„é‹ç®—å¡ï¼š
- Slot 1 å¯èƒ½æ˜¯ CPU å¡
- Slot 2 å¯èƒ½æ˜¯ GPU å¡
- Slot 3 å¯èƒ½æ˜¯ç©ºçš„

entity-manager çš„å„ªå‹¢ï¼š
1. Probe æ©Ÿåˆ¶å¯ä»¥å‹•æ…‹åµæ¸¬æ¯å€‹ Slot æ’äº†ä»€éº¼
2. æ ¹æ“šåµæ¸¬çµæœè¼‰å…¥å°æ‡‰çš„ Sensor è¨­å®š
3. ä¸éœ€è¦ç‚ºæ¯ç¨®çµ„åˆé‡æ–°ç·¨è­¯éŸŒé«”

å¯¦éš›é‹ä½œæµç¨‹ï¼š
1. entity-manager å•Ÿå‹•
2. è®€å– /usr/share/entity-manager/configurations/*.json
3. åŸ·è¡Œ Probe æ¢ä»¶ï¼ˆå¦‚ï¼šæª¢æŸ¥ I2C åœ°å€æ˜¯å¦æœ‰å›æ‡‰ï¼‰
4. Probe æˆåŠŸ â†’ åœ¨ D-Bus ç™¼å¸ƒ Inventory ç‰©ä»¶
5. dbus-sensors è¨‚é–± D-Busï¼Œç™¼ç¾æ–°ç¡¬é«”
6. å»ºç«‹å°æ‡‰çš„ Sensor ç‰©ä»¶ã€
```

---

**Q5ï¼šIPMI å’Œ Redfish çš„å·®ç•°ï¼Ÿç‚ºä»€éº¼è¶¨å‹¢æ˜¯ Redfishï¼Ÿ**

```
ã€Œé€™æ˜¯ BMC é ˜åŸŸçš„é‡è¦è­°é¡Œï¼Œæˆ‘ä¾†è©³ç´°èªªæ˜ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                â”‚        IPMI          â”‚       Redfish        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åˆ¶å®šçµ„ç¹”       â”‚ Intel (å·²è½‰ç§» DMTF)  â”‚ DMTF                 â”‚
â”‚ å”å®šæ ¼å¼       â”‚ äºŒé€²ä½               â”‚ JSON over HTTPS      â”‚
â”‚ å‚³è¼¸æ–¹å¼       â”‚ UDP/LAN, KCS, BT     â”‚ HTTPS (TCP)          â”‚
â”‚ å®‰å…¨æ€§         â”‚ è¼ƒå¼±*                â”‚ TLS + èªè­‰           â”‚
â”‚ å¯è®€æ€§         â”‚ éœ€è¦è§£æ             â”‚ äººé¡å¯è®€             â”‚
â”‚ æ“´å±•æ€§         â”‚ OEM Command          â”‚ Schema + OEM         â”‚
â”‚ å­¸ç¿’æ›²ç·š       â”‚ é™¡å³­                 â”‚ è¼ƒå¹³ç·©               â”‚
â”‚ é™¤éŒ¯é›£åº¦       â”‚ éœ€è¦ç‰¹æ®Šå·¥å…·         â”‚ curl å³å¯            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

* IPMI å®‰å…¨æ€§å•é¡Œï¼š
  - IPMI v1.5 å¯†ç¢¼æ˜æ–‡å‚³è¼¸
  - IPMI v2.0 æœ‰ RMCP+ ä½†å¯¦ä½œå¸¸æœ‰æ¼æ´
  - 2013 å¹´ç™¼ç¾é‡å¤§æ¼æ´ï¼ˆcipher 0 å•é¡Œï¼‰

ç‚ºä»€éº¼è¶¨å‹¢æ˜¯ Redfishï¼Ÿ
1. å®‰å…¨æ€§ï¼šåŸºæ–¼ HTTPSï¼Œç¬¦åˆç¾ä»£å®‰å…¨æ¨™æº–
2. é›²ç«¯æ•´åˆï¼šJSON æ ¼å¼æ˜“æ–¼èˆ‡é›²ç«¯ç®¡ç†ç³»çµ±æ•´åˆ
3. äº‹ä»¶è¨‚é–±ï¼šæ”¯æ´ EventDestinationï¼Œå¯ä¸»å‹•æ¨é€äº‹ä»¶
4. è±å¯Œè³‡è¨Šï¼šæ¯” IPMI èƒ½æä¾›æ›´è©³ç´°çš„ç³»çµ±è³‡è¨Š
5. ç‰ˆæœ¬æ¼”é€²ï¼šDMTF ä»åœ¨ç©æ¥µæ›´æ–°è¦æ ¼

ä½† IPMI ä»ç„¶é‡è¦çš„åŸå› ï¼š
1. å‘å¾Œç›¸å®¹ï¼šå¤§é‡ç¾æœ‰å·¥å…·ä¾è³´ IPMI
2. SOL (Serial over LAN)ï¼šRedfish ä»ä¸å¦‚ IPMI SOL æˆç†Ÿ
3. æŸäº›ä½éšæ“ä½œï¼šå¦‚ BIOS æ›´æ–°ï¼Œä»å¸¸ç”¨ IPMIã€
```

---

**Q6ï¼šå¦‚ä½• debug ä¸€å€‹ã€Sensor è®€ä¸åˆ°å€¼ã€çš„å•é¡Œï¼Ÿ**

```
ã€Œé€™æ˜¯å¾ˆå¯¦éš›çš„å•é¡Œã€‚æˆ‘æœƒæŒ‰ç…§å¾åº•å±¤åˆ°ä¸Šå±¤çš„é †åºæ’æŸ¥ï¼š

1. ç¢ºèªç¡¬é«”é€£æ¥
   i2cdetect -y <bus>
   # ç¢ºèª Sensor çš„ I2C åœ°å€æœ‰å›æ‡‰ï¼ˆçœ‹åˆ°æ•¸å­—è€Œé --ï¼‰

2. ç¢ºèª Kernel Driver
   dmesg | grep -i hwmon
   ls /sys/class/hwmon/
   # ç¢ºèª hwmon ç¯€é»æœ‰å»ºç«‹

3. ç¢ºèª sysfs æ•¸å€¼
   cat /sys/class/hwmon/hwmon*/temp*_input
   # å¦‚æœé€™è£¡æ²’å€¼ï¼Œå•é¡Œåœ¨ driver å±¤

4. ç¢ºèª D-Bus æœå‹™
   systemctl status xyz.openbmc_project.HwmonTempSensor
   journalctl -u xyz.openbmc_project.HwmonTempSensor
   # çœ‹æœ‰æ²’æœ‰éŒ¯èª¤è¨Šæ¯

5. ç¢ºèª D-Bus ç‰©ä»¶
   busctl tree xyz.openbmc_project.HwmonTempSensor
   # ç¢ºèª Sensor ç‰©ä»¶æœ‰å»ºç«‹
   
   busctl get-property xyz.openbmc_project.HwmonTempSensor \
       /xyz/openbmc_project/sensors/temperature/CPU0_Temp \
       xyz.openbmc_project.Sensor.Value Value
   # ç¢ºèªå¯ä»¥è®€åˆ°å€¼

6. ç¢ºèª Redfish
   curl -k -u root:password \
       https://localhost/redfish/v1/Chassis/chassis/Sensors

å¸¸è¦‹å•é¡Œå’Œè§£æ³•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¾è±¡                    â”‚ å¯èƒ½åŸå›                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ i2cdetect çœ‹ä¸åˆ°        â”‚ 1. æ¥ç·šå•é¡Œ 2. I2C Bus éŒ¯èª¤         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ sysfs æ²’æœ‰ç¯€é»          â”‚ 1. Driver æ²’è¼‰å…¥ 2. Device Tree éŒ¯  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ sysfs æœ‰å€¼ä½† D-Bus æ²’æœ‰ â”‚ 1. è¨­å®šæª”éŒ¯èª¤ 2. æœå‹™æ²’å•Ÿå‹•         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ D-Bus æœ‰ä½† Redfish æ²’æœ‰ â”‚ 1. bmcweb è¨­å®šå•é¡Œ 2. Sensor å‘½å   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Q7ï¼šä½ åœ¨ OpenBMC åšéä»€éº¼åŠŸèƒ½ï¼Ÿï¼ˆSTAR æ¡†æ¶å›ç­”ï¼‰**

```
é€™é¡Œå¿…é ˆæº–å‚™ï¼ä»¥ä¸‹æ˜¯ç¯„ä¾‹æ¡†æ¶ï¼Œä½ éœ€è¦å¡«å…¥è‡ªå·±çš„ç¶“é©—ï¼š

ç¯„ä¾‹ä¸€ï¼šæ–°å¢ Sensor æ”¯æ´
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Situationï¼š
ã€Œæˆ‘å€‘çš„ Yosemite 4 å¹³å°æ–°å¢äº†ä¸€æ¬¾ GPU é‹ç®—å¡ï¼Œ
ä¸Šé¢æœ‰æ–°çš„é›»æºç®¡ç† IC (MPS MP2973)ï¼Œéœ€è¦è®€å–åŠŸè€—è³‡æ–™ã€‚ã€

Taskï¼š
ã€Œæˆ‘è² è²¬åœ¨ OpenBMC ä¸Šæ–°å¢é€™é¡† IC çš„ Sensor æ”¯æ´ï¼Œ
è®“ä½¿ç”¨è€…å¯ä»¥é€é Redfish è®€å– GPU åŠŸè€—ã€‚ã€

Actionï¼š
ã€Œ1. é¦–å…ˆç ”ç©¶ MP2973 çš„ datasheetï¼Œäº†è§£ I2C æš«å­˜å™¨å®šç¾©
 2. ç¢ºèªç¾æœ‰çš„ hwmon driver ä¸æ”¯æ´ï¼Œéœ€è¦æ–°å¢
 3. åœ¨ entity-manager æ–°å¢ JSON è¨­å®šï¼Œå®šç¾© I2C Bus å’Œ Address
 4. åœ¨ dbus-sensors æ–°å¢ MPS MP2973 çš„è®€å–é‚è¼¯
 5. æ’°å¯«å–®å…ƒæ¸¬è©¦ï¼Œç¢ºä¿åŠŸè€—è¨ˆç®—å…¬å¼æ­£ç¢º
 6. åœ¨å¯¦éš›ç¡¬é«”ä¸Šé©—è­‰ D-Bus å’Œ Redfish éƒ½å¯ä»¥æ­£ç¢ºè®€å–
 7. æäº¤ PRï¼Œç¶“é code review å¾Œåˆä½µã€

Resultï¼š
ã€ŒæˆåŠŸä¸Šç·šï¼Œå®¢æˆ¶å¯ä»¥é€é Redfish ç›£æ§ GPU åŠŸè€—ï¼Œ
é€™å€‹åŠŸèƒ½ä¹Ÿè¢«ä¸Šæ¸¸ OpenBMC æ¥å—ï¼Œè²¢ç»çµ¦ç¤¾ç¾¤ã€‚ã€

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ç¯„ä¾‹äºŒï¼šä¿®å¾© Fan PWM å•é¡Œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Situationï¼š
ã€ŒQA å›å ±é¢¨æ‰‡è½‰é€Ÿæ§åˆ¶ä¸ç©©å®šï¼Œæœ‰æ™‚å€™ PWM è¨­å®šæ²’æœ‰ç”Ÿæ•ˆã€‚ã€

Taskï¼š
ã€ŒDebug ä¸¦ä¿®å¾©é€™å€‹å•é¡Œã€‚ã€

Actionï¼š
ã€Œ1. ç”¨ busctl monitor è§€å¯Ÿ Fan PWM çš„ D-Bus è¨Šæ¯æµ
 2. ç™¼ç¾è¨­å®š PWM å¾Œï¼Œæœ‰å¦ä¸€å€‹æœå‹™åˆæŠŠå®ƒæ”¹å›å»
 3. è¿½è¹¤ç™¼ç¾æ˜¯ phosphor-fan-control çš„ PID æ§åˆ¶è¦†è“‹äº†æ‰‹å‹•è¨­å®š
 4. ç ”ç©¶ fan-control çš„ç¨‹å¼ç¢¼ï¼Œç™¼ç¾éœ€è¦åŠ  Manual Override æ©Ÿåˆ¶
 5. ä¿®æ”¹ç¨‹å¼ç¢¼ï¼Œæ–°å¢ ManualMode å±¬æ€§
 6. ç•¶ ManualMode = true æ™‚ï¼ŒPID ä¸æœƒè¦†è“‹ PWMã€

Resultï¼š
ã€Œä¿®å¾©å¾Œ QA é©—è­‰é€šéï¼Œä¹Ÿç™¼ç¾é€™æ˜¯ä¸Šæ¸¸çš„å·²çŸ¥å•é¡Œï¼Œ
æˆ‘æŠŠä¿®å¾©æäº¤çµ¦ä¸Šæ¸¸ï¼Œè¢«æ¥å—åˆä½µã€‚ã€
```

---

**Q8ï¼šOpenBMC å¦‚ä½•è™•ç† Host é›»æºç‹€æ…‹ç®¡ç†ï¼Ÿ**

```
ã€Œé›»æºç‹€æ…‹ç®¡ç†æ˜¯ BMC çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚

ç‹€æ…‹æ©Ÿï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Host Power State Machine                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Power On     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚    â”‚   Off   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ Running  â”‚                 â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                           â”‚                        â”‚
â”‚         â”‚                           â”‚ Power Off / Reboot     â”‚
â”‚         â”‚                           â–¼                        â”‚
â”‚         â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Quiesced â”‚                  â”‚
â”‚         â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

D-Bus ä»‹é¢ï¼š
- Service: xyz.openbmc_project.State.Host
- Object: /xyz/openbmc_project/state/host0
- Properties:
  - CurrentHostState (Running/Off/Quiesced/...)
  - RequestedHostTransition (On/Off/Reboot/...)

é›»æºæ§åˆ¶æ–¹å¼ï¼š
1. D-Bus æ–¹æ³•å‘¼å«
   busctl set-property xyz.openbmc_project.State.Host \
       /xyz/openbmc_project/state/host0 \
       xyz.openbmc_project.State.Host \
       RequestedHostTransition s \
       "xyz.openbmc_project.State.Host.Transition.On"

2. Redfish API
   POST /redfish/v1/Systems/system/Actions/ComputerSystem.Reset
   { "ResetType": "On" }

3. IPMI Command
   ipmitool power on

å¯¦éš›é›»æºæ§åˆ¶ GPIOï¼š
BMC é€šå¸¸é€é GPIO æ§åˆ¶é›»æºï¼š
- POWER_BUTTON (GPIO è§¸ç™¼é–‹æ©Ÿ)
- RESET_BUTTON (GPIO è§¸ç™¼é‡é–‹)
- POWER_GOOD (GPIO è®€å–é›»æºç‹€æ…‹)

é€™äº› GPIO çš„å®šç¾©åœ¨ Device Tree æˆ– Entity-Manager JSON ä¸­ã€
```

---

### ğŸ¯ å¯¦æˆ°é¡Œ

**Q9ï¼šå¦‚æœè¦åœ¨ OpenBMC æ–°å¢ä¸€å€‹å…¨æ–°çš„ I2C Sensorï¼Œéœ€è¦æ”¹å“ªäº›æ±è¥¿ï¼Ÿ**

```
ã€Œé€™é¡Œè€ƒé©—ä½ å°æ•´å€‹é–‹ç™¼æµç¨‹çš„ç†è§£ã€‚

å‡è¨­è¦æ–°å¢ä¸€å€‹æ–°çš„æº«åº¦ Sensor ICï¼šABC1234

éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼ˆä½¿ç”¨ entity-manager + dbus-sensorsï¼‰ï¼š

1. Linux Kernel Driverï¼ˆå¦‚æœ kernel æ²’æœ‰æ”¯æ´ï¼‰
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ä½ç½®ï¼šLinux kernel ä¸Šæ¸¸æˆ– meta-phosphor/recipes-kernel/
   
   éœ€è¦å¯«ä¸€å€‹ hwmon driverï¼Œæˆ–ç¢ºèªç¾æœ‰ driver æ”¯æ´

2. Entity-Manager JSON è¨­å®š
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ä½ç½®ï¼š/usr/share/entity-manager/configurations/
   
   æ–°å¢æˆ–ä¿®æ”¹ JSONï¼š
   {
       "Exposes": [{
           "Name": "New Sensor",
           "Type": "ABC1234",
           "Bus": 2,
           "Address": "0x48"
       }],
       "Probe": "xyz.openbmc_project.FruDevice({'ADDRESS': 72})"
   }

3. dbus-sensorsï¼ˆå¦‚æœ dbus-sensors æ²’æœ‰æ”¯æ´ï¼‰
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ä½ç½®ï¼šopenbmc/dbus-sensors
   
   å¯èƒ½éœ€è¦æ–°å¢ä¸€å€‹ Sensor é¡åˆ¥ï¼š
   - æ–°å¢ include/ABC1234Sensor.hpp
   - æ–°å¢ src/ABC1234Sensor.cpp
   - ä¿®æ”¹ CMakeLists.txt

4. Recipe / Meta Layer
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   å¦‚æœæ˜¯å» å•†ç‰¹å®šçš„ï¼Œéœ€è¦åœ¨ meta-xxx layer æ–°å¢ï¼š
   - è¨­å®šæª” (JSON)
   - å¯èƒ½çš„ patch

é–‹ç™¼å’Œé©—è­‰æ­¥é©Ÿï¼š
1. åœ¨å¯¦æ©Ÿç”¨ i2cdetect ç¢ºèª Sensor å¯åµæ¸¬
2. ç·¨è­¯åŒ…å«æ–° driver çš„ kernel
3. ç·¨è­¯åŒ…å«æ–°è¨­å®šçš„ entity-manager
4. Flash æ–°éŸŒé«”
5. é©—è­‰ sysfs â†’ D-Bus â†’ Redfish éƒ½æ­£ç¢º
```

---

## âœ… é¢è©¦å‰è¤‡ç¿’æ¸…å–®

```
æ ¸å¿ƒæ¦‚å¿µï¼š
â˜ èƒ½ç•«å‡º OpenBMC å››å±¤æ¶æ§‹åœ–
â˜ èƒ½è§£é‡‹ D-Bus çš„å››å¤§åŠŸèƒ½ï¼ˆç™¼ç¾ã€å‘¼å«ã€å±¬æ€§ã€ä¿¡è™Ÿï¼‰
â˜ èƒ½èªªæ˜ Sensor è³‡æ–™å¾ç¡¬é«”åˆ° Redfish çš„å®Œæ•´æµç¨‹
â˜ çŸ¥é“ IPMI å’Œ Redfish çš„å·®ç•°åŠè¶¨å‹¢

æŠ€è¡“ç´°ç¯€ï¼š
â˜ çŸ¥é“ entity-manager vs phosphor-inventory-manager å·®ç•°
â˜ èƒ½è§£é‡‹ entity-manager çš„ Probe æ©Ÿåˆ¶
â˜ çŸ¥é“ phosphor-hwmon vs dbus-sensors çš„å·®ç•°
â˜ æœƒä½¿ç”¨ busctl æŸ¥è©¢å’Œç›£æ§ D-Bus

å¯¦ä½œç¶“é©—ï¼š
â˜ æº–å‚™å¥½ 2-3 å€‹è‡ªå·±åšéçš„åŠŸèƒ½æ¡ˆä¾‹ï¼ˆç”¨ STAR æ¡†æ¶ï¼‰
â˜ èƒ½èªªæ˜ Debug Sensor å•é¡Œçš„æ­¥é©Ÿ
â˜ çŸ¥é“æ–°å¢ Sensor éœ€è¦æ”¹å“ªäº›æª”æ¡ˆ

Build ç›¸é—œï¼š
â˜ çŸ¥é“ Yocto build system åŸºæœ¬æ“ä½œ
â˜ çŸ¥é“ meta-layer çš„çµæ§‹å’Œç”¨é€”
â˜ æœƒä½¿ç”¨ devtool é€²è¡Œé–‹ç™¼

åŠ åˆ†é …ç›®ï¼š
â˜ æœ‰è²¢ç»éä¸Šæ¸¸ç¨‹å¼ç¢¼
â˜ äº†è§£ phosphor-dbus-interfaces çš„è§’è‰²
â˜ çŸ¥é“é›»æºç‹€æ…‹ç®¡ç†çš„ç‹€æ…‹æ©Ÿ
```
